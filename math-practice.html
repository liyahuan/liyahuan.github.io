<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹¼å°è¡”æ¥å£ç®—ç»ƒä¹ </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#64748b',
                        accent: '#f97316',
                        dark: '#1e293b',
                        light: '#f8fafc',
                        success: '#10b981',
                        warning: '#f59e0b',
                        danger: '#ef4444',
                        happy: '#8b5cf6',
                        fun: '#ec4899',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        comic: ['Comic Sans MS', 'cursive', 'sans-serif'],
                    },
                    animation: {
                        'bounce-slow': 'bounce 2s infinite',
                        'wiggle': 'wiggle 1s ease-in-out infinite',
                        'pulse-slow': 'pulse 3s infinite',
                    },
                    keyframes: {
                        wiggle: {
                            '0%, 100%': { transform: 'rotate(-3deg)' },
                            '50%': { transform: 'rotate(3deg)' },
                        }
                    }
                },
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .transition-all-300 {
                transition: all 300ms ease-in-out;
            }
            .btn-hover {
                @apply hover:scale-105 transition-all duration-300 hover:shadow-lg;
            }
            .card-hover {
                @apply hover:shadow-xl transition-all duration-300 hover:-translate-y-1;
            }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-purple-50 min-h-screen font-comic text-dark">
    <!-- å¯¼èˆªæ  -->
    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <div class="w-10 h-10 sm:w-12 sm:h-12 bg-primary rounded-full flex items-center justify-center">
                    <span class="text-white font-bold text-xl sm:text-2xl">ğŸ§®</span>
                </div>
                <h1 class="text-lg sm:text-2xl font-bold text-dark">è¶£å‘³å£ç®—ç»ƒä¹ </h1>
            </div>
            <div class="flex items-center gap-2 sm:gap-4">
                <button id="soundToggle" class="w-8 h-8 sm:w-10 sm:h-10 bg-light rounded-full flex items-center justify-center btn-hover">
                    <span class="text-base sm:text-xl">ğŸ”Š</span>
                </button>
                <button id="helpBtn" class="w-8 h-8 sm:w-10 sm:h-10 bg-light rounded-full flex items-center justify-center btn-hover">
                    <span class="text-base sm:text-xl">â“</span>
                </button>
            </div>
        </div>
    </header>

    <!-- ä¸»å†…å®¹åŒº -->
    <main class="container mx-auto px-4 py-8">
        <!-- æ¬¢è¿åŒº -->
        <section id="welcomeSection" class="bg-white rounded-2xl shadow-lg p-6 sm:p-8 mb-8 text-center">
            <div class="mb-4 sm:mb-6">
                <span class="text-4xl sm:text-6xl">ğŸ‰</span>
            </div>
            <h2 class="text-2xl sm:text-3xl font-bold mb-4 text-primary">æ¬¢è¿æ¥åˆ°è¶£å‘³å£ç®—ç»ƒä¹ ï¼</h2>
            <p class="text-base sm:text-lg text-secondary mb-6 sm:mb-8">
                å°æœ‹å‹ä»¬ï¼Œè®©æˆ‘ä»¬ä¸€èµ·å¿«ä¹å­¦ä¹ æ•°å­¦å§ï¼
            </p>
            <div class="flex flex-col sm:flex-row flex-wrap justify-center gap-4">
                <button id="startPractice" class="bg-primary text-white px-6 sm:px-8 py-3 sm:py-4 rounded-xl text-base sm:text-xl font-bold btn-hover">
                    å¼€å§‹ç»ƒä¹ 
                </button>
                <button id="viewAchievements" class="bg-accent text-white px-6 sm:px-8 py-3 sm:py-4 rounded-xl text-base sm:text-xl font-bold btn-hover">
                    æŸ¥çœ‹æˆå°±
                </button>
            </div>
        </section>

        <!-- ç»ƒä¹ è®¾ç½®åŒº -->
        <section id="settingsSection" class="bg-white rounded-2xl shadow-lg p-6 sm:p-8 mb-8 hidden">
            <div class="flex justify-between items-center mb-6">
                <button id="backToWelcomeFromSettings" class="bg-secondary text-white px-3 sm:px-4 py-1 sm:py-2 rounded-lg font-bold btn-hover text-sm sm:text-base">
                    <span class="mr-1 sm:mr-2">ğŸ </span> è¿”å›ä¸»é¡µ
                </button>
                <h2 class="text-xl sm:text-2xl font-bold text-center">ç»ƒä¹ è®¾ç½®</h2>
                <div class="w-16 sm:w-24"></div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 sm:gap-8">
                <!-- ç»ƒä¹ ç±»å‹ -->
                <div>
                    <h3 class="text-base sm:text-lg font-bold mb-4 text-secondary">ç»ƒä¹ ç±»å‹</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <button class="practice-type-btn bg-blue-100 text-primary py-3 rounded-xl font-bold text-center card-hover" data-type="addition">
                            <span class="text-xl sm:text-2xl mb-2 block">â•</span>
                            åŠ æ³•
                        </button>
                        <button class="practice-type-btn bg-green-100 text-success py-3 rounded-xl font-bold text-center card-hover" data-type="subtraction">
                            <span class="text-xl sm:text-2xl mb-2 block">â–</span>
                            å‡æ³•
                        </button>
                    </div>
                </div>
                
                <!-- éš¾åº¦çº§åˆ« -->
                <div>
                    <h3 class="text-base sm:text-lg font-bold mb-4 text-secondary">éš¾åº¦çº§åˆ«</h3>
                    <div class="space-y-4">
                        <button class="difficulty-btn bg-light border-2 border-gray-200 py-3 rounded-xl font-bold text-center card-hover" data-level="easy">
                            <span class="text-base sm:text-xl mb-1 block">ğŸ£</span>
                            åˆçº§ (5ä»¥å†…)
                        </button>
                        <button class="difficulty-btn bg-light border-2 border-gray-200 py-3 rounded-xl font-bold text-center card-hover" data-level="medium">
                            <span class="text-base sm:text-xl mb-1 block">ğŸ¥</span>
                            ä¸­çº§ (10ä»¥å†…)
                        </button>
                        <button class="difficulty-btn bg-light border-2 border-gray-200 py-3 rounded-xl font-bold text-center card-hover" data-level="hard">
                            <span class="text-base sm:text-xl mb-1 block">ğŸ”</span>
                            é«˜çº§ (20ä»¥å†…)
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="mt-6 sm:mt-8 text-center">
                <button id="confirmSettings" class="bg-primary text-white px-6 sm:px-8 py-3 sm:py-4 rounded-xl text-base sm:text-xl font-bold btn-hover">
                    ç¡®è®¤è®¾ç½®
                </button>
            </div>
        </section>

        <!-- ç»ƒä¹ åŒº -->
        <section id="practiceSection" class="bg-white rounded-2xl shadow-lg p-6 sm:p-8 mb-8 hidden">
            <!-- é¡¶éƒ¨æ§åˆ¶æ  -->
            <div class="flex justify-between items-center mb-6 sm:mb-8">
                <button id="backToWelcomeFromPractice" class="bg-secondary text-white px-3 sm:px-4 py-1 sm:py-2 rounded-lg font-bold btn-hover text-sm sm:text-base">
                    <span class="mr-1 sm:mr-2">ğŸ </span> è¿”å›ä¸»é¡µ
                </button>
                <div>
                    <span class="font-bold text-sm sm:text-base">è¿›åº¦: </span>
                    <span id="progressText" class="text-sm sm:text-base">0/10</span>
                </div>
            </div>
            
            <!-- è¿›åº¦æ¡ -->
            <div class="mb-6 sm:mb-8">
                <div class="w-full bg-gray-200 rounded-full h-4">
                    <div id="progressBar" class="bg-primary h-4 rounded-full" style="width: 0%"></div>
                </div>
            </div>
            
            <!-- é¢˜ç›®åŒº -->
            <div class="mb-8 sm:mb-12 text-center">
                <div id="visualization" class="flex items-center justify-center gap-4 sm:gap-8 mb-6 sm:mb-8">
                    <div class="text-2xl sm:text-4xl font-bold" id="num1">8</div>
                    <div class="text-2xl sm:text-4xl font-bold" id="operator">+</div>
                    <div class="text-2xl sm:text-4xl font-bold" id="num2">5</div>
                    <div class="text-2xl sm:text-4xl font-bold">=</div>
                    <div class="w-20 sm:w-24 h-12 sm:h-16 border-2 border-primary rounded-xl flex items-center justify-center" id="answerBox">
                        <span id="answer" class="text-xl sm:text-2xl">?</span>
                    </div>
                </div>
                
                <!-- è®¡ç®—è¿‡ç¨‹å¯è§†åŒ– -->
                <div id="calculationVisualization" class="bg-blue-50 rounded-xl p-4 sm:p-6 mb-6 sm:mb-8 hidden">
                    <h3 class="text-base sm:text-lg font-bold mb-3 sm:mb-4">è®¡ç®—è¿‡ç¨‹</h3>
                    <div id="visualizationSteps" class="space-y-3 sm:space-y-4">
                        <!-- è®¡ç®—æ­¥éª¤å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>
            
            <!-- è¾“å…¥åŒº -->
            <div class="mb-6 sm:mb-8">
                <h3 class="text-base sm:text-lg font-bold mb-3 sm:mb-4 text-center">è¯·è¾“å…¥ç­”æ¡ˆ</h3>
                <div class="grid grid-cols-3 gap-3 sm:gap-4 max-w-md mx-auto">
                    <button class="number-btn bg-light border-2 border-gray-200 py-3 sm:py-4 rounded-xl font-bold text-xl sm:text-2xl text-center card-hover">1</button>
                    <button class="number-btn bg-light border-2 border-gray-200 py-3 sm:py-4 rounded-xl font-bold text-xl sm:text-2xl text-center card-hover">2</button>
                    <button class="number-btn bg-light border-2 border-gray-200 py-3 sm:py-4 rounded-xl font-bold text-xl sm:text-2xl text-center card-hover">3</button>
                    <button class="number-btn bg-light border-2 border-gray-200 py-3 sm:py-4 rounded-xl font-bold text-xl sm:text-2xl text-center card-hover">4</button>
                    <button class="number-btn bg-light border-2 border-gray-200 py-3 sm:py-4 rounded-xl font-bold text-xl sm:text-2xl text-center card-hover">5</button>
                    <button class="number-btn bg-light border-2 border-gray-200 py-3 sm:py-4 rounded-xl font-bold text-xl sm:text-2xl text-center card-hover">6</button>
                    <button class="number-btn bg-light border-2 border-gray-200 py-3 sm:py-4 rounded-xl font-bold text-xl sm:text-2xl text-center card-hover">7</button>
                    <button class="number-btn bg-light border-2 border-gray-200 py-3 sm:py-4 rounded-xl font-bold text-xl sm:text-2xl text-center card-hover">8</button>
                    <button class="number-btn bg-light border-2 border-gray-200 py-3 sm:py-4 rounded-xl font-bold text-xl sm:text-2xl text-center card-hover">9</button>
                    <button class="bg-primary text-white py-3 sm:py-4 rounded-xl font-bold text-xl sm:text-2xl text-center btn-hover" id="clearBtn">æ¸…é™¤</button>
                    <button class="number-btn bg-light border-2 border-gray-200 py-3 sm:py-4 rounded-xl font-bold text-xl sm:text-2xl text-center card-hover">0</button>
                    <button class="bg-success text-white py-3 sm:py-4 rounded-xl font-bold text-xl sm:text-2xl text-center btn-hover" id="submitBtn">æäº¤</button>
                </div>
            </div>
            
            <!-- æ§åˆ¶æŒ‰é’® -->
            <div class="flex flex-wrap justify-center gap-3 sm:gap-4">
                <button id="listenQuestion" class="bg-accent text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-bold btn-hover text-sm sm:text-base">
                    <span class="mr-1 sm:mr-2">ğŸ”Š</span> å¬é¢˜ç›®
                </button>
                <button id="showHint" class="bg-warning text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-bold btn-hover text-sm sm:text-base">
                    <span class="mr-1 sm:mr-2">ğŸ’¡</span> æç¤º
                </button>
                <button id="skipQuestion" class="bg-secondary text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-bold btn-hover text-sm sm:text-base">
                    <span class="mr-1 sm:mr-2">â­ï¸</span> è·³è¿‡
                </button>
            </div>
        </section>

        <!-- ç»“æœåŒº -->
        <section id="resultSection" class="bg-white rounded-2xl shadow-lg p-6 sm:p-8 mb-8 hidden">
            <div class="text-center mb-6 sm:mb-8">
                <div id="resultEmoji" class="text-6xl sm:text-8xl mb-3 sm:mb-4">ğŸ‰</div>
                <h2 class="text-2xl sm:text-3xl font-bold mb-3 sm:mb-4" id="resultTitle">ç»ƒä¹ å®Œæˆï¼</h2>
                <p class="text-base sm:text-xl mb-4 sm:mb-6" id="resultMessage">ä½ å¤ªæ£’äº†ï¼</p>
                
                <div class="flex justify-center gap-4 sm:gap-8 mb-6 sm:mb-8">
                    <div class="text-center">
                        <div class="text-3xl sm:text-4xl font-bold text-primary mb-2" id="correctCount">8</div>
                        <div class="text-secondary text-sm sm:text-base">æ­£ç¡®é¢˜æ•°</div>
                    </div>
                    <div class="text-center">
                        <div class="text-3xl sm:text-4xl font-bold text-accent mb-2" id="accuracy">80%</div>
                        <div class="text-secondary text-sm sm:text-base">æ­£ç¡®ç‡</div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 sm:gap-4 max-w-2xl mx-auto">
                    <button id="retryBtn" class="bg-primary text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-bold btn-hover text-sm sm:text-base">
                        å†è¯•ä¸€æ¬¡
                    </button>
                    <button id="changeSettingsBtn" class="bg-accent text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-bold btn-hover text-sm sm:text-base">
                        æ›´æ”¹è®¾ç½®
                    </button>
                    <button id="backToWelcomeBtn" class="bg-secondary text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-bold btn-hover text-sm sm:text-base">
                        è¿”å›é¦–é¡µ
                    </button>
                </div>
            </div>
        </section>

        <!-- æˆå°±åŒº -->
        <section id="achievementsSection" class="bg-white rounded-2xl shadow-lg p-6 sm:p-8 mb-8 hidden">
            <div class="flex justify-between items-center mb-6">
                <button id="backFromAchievements" class="bg-secondary text-white px-3 sm:px-4 py-1 sm:py-2 rounded-lg font-bold btn-hover text-sm sm:text-base">
                    <span class="mr-1 sm:mr-2">ğŸ </span> è¿”å›ä¸»é¡µ
                </button>
                <h2 class="text-xl sm:text-2xl font-bold text-center">æˆ‘çš„æˆå°±</h2>
                <div class="w-16 sm:w-24"></div>
            </div>
            
            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 sm:gap-4">
                <div class="achievement-card bg-light rounded-xl p-3 sm:p-4 text-center card-hover">
                    <div class="text-2xl sm:text-3xl mb-1 sm:mb-2">ğŸ†</div>
                    <div class="font-bold text-sm sm:text-base">åˆçº§ç®—æœ¯ç‹</div>
                    <div class="text-xs sm:text-sm text-secondary">å®Œæˆ10æ¬¡åˆçº§ç»ƒä¹ </div>
                </div>
                <div class="achievement-card bg-light rounded-xl p-3 sm:p-4 text-center card-hover">
                    <div class="text-2xl sm:text-3xl mb-1 sm:mb-2">â­</div>
                    <div class="font-bold text-sm sm:text-base">ä¸­çº§ç®—æœ¯ç‹</div>
                    <div class="text-xs sm:text-sm text-secondary">å®Œæˆ10æ¬¡ä¸­çº§ç»ƒä¹ </div>
                </div>
                <div class="achievement-card bg-light rounded-xl p-3 sm:p-4 text-center card-hover">
                    <div class="text-2xl sm:text-3xl mb-1 sm:mb-2">ğŸ’</div>
                    <div class="font-bold text-sm sm:text-base">é«˜çº§ç®—æœ¯ç‹</div>
                    <div class="text-xs sm:text-sm text-secondary">å®Œæˆ10æ¬¡é«˜çº§ç»ƒä¹ </div>
                </div>
                <div class="achievement-card bg-light rounded-xl p-3 sm:p-4 text-center card-hover">
                    <div class="text-2xl sm:text-3xl mb-1 sm:mb-2">ğŸ”¥</div>
                    <div class="font-bold text-sm sm:text-base">åŠ æ³•å¤§å¸ˆ</div>
                    <div class="text-xs sm:text-sm text-secondary">åŠ æ³•æ­£ç¡®ç‡100%</div>
                </div>
                <div class="achievement-card bg-light rounded-xl p-3 sm:p-4 text-center card-hover">
                    <div class="text-2xl sm:text-3xl mb-1 sm:mb-2">â„ï¸</div>
                    <div class="font-bold text-sm sm:text-base">å‡æ³•å¤§å¸ˆ</div>
                    <div class="text-xs sm:text-sm text-secondary">å‡æ³•æ­£ç¡®ç‡100%</div>
                </div>
                <div class="achievement-card bg-light rounded-xl p-3 sm:p-4 text-center card-hover">
                    <div class="text-2xl sm:text-3xl mb-1 sm:mb-2">âš¡</div>
                    <div class="font-bold text-sm sm:text-base">ä¹˜æ³•å¤§å¸ˆ</div>
                    <div class="text-xs sm:text-sm text-secondary">ä¹˜æ³•æ­£ç¡®ç‡100%</div>
                </div>
                <div class="achievement-card bg-light rounded-xl p-3 sm:p-4 text-center card-hover">
                    <div class="text-2xl sm:text-3xl mb-1 sm:mb-2">ğŸ’§</div>
                    <div class="font-bold text-sm sm:text-base">é™¤æ³•å¤§å¸ˆ</div>
                    <div class="text-xs sm:text-sm text-secondary">é™¤æ³•æ­£ç¡®ç‡100%</div>
                </div>
                <div class="achievement-card bg-light rounded-xl p-3 sm:p-4 text-center card-hover">
                    <div class="text-2xl sm:text-3xl mb-1 sm:mb-2">ğŸŒŸ</div>
                    <div class="font-bold text-sm sm:text-base">å…¨èƒ½ç®—æœ¯ç‹</div>
                    <div class="text-xs sm:text-sm text-secondary">å®Œæˆæ‰€æœ‰ç±»å‹ç»ƒä¹ </div>
                </div>
            </div>
            
            <div class="mt-6 sm:mt-8 text-center">
                <button id="backFromAchievementsBtn" class="bg-primary text-white px-6 sm:px-8 py-2 sm:py-3 rounded-xl font-bold btn-hover text-sm sm:text-base">
                    è¿”å›é¦–é¡µ
                </button>
            </div>
        </section>

        <!-- å¸®åŠ©æ¨¡æ€æ¡† -->
        <div id="helpModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold">å¦‚ä½•ä½¿ç”¨</h3>
                    <button id="closeHelpModal" class="text-2xl">âœ•</button>
                </div>
                <div class="space-y-4">
                    <div>
                        <h4 class="font-bold mb-2">1. å¼€å§‹ç»ƒä¹ </h4>
                        <p>ç‚¹å‡»"å¼€å§‹ç»ƒä¹ "æŒ‰é’®ï¼Œè¿›å…¥ç»ƒä¹ è®¾ç½®é¡µé¢ã€‚</p>
                    </div>
                    <div>
                        <h4 class="font-bold mb-2">2. é€‰æ‹©ç»ƒä¹ ç±»å‹</h4>
                        <p>é€‰æ‹©ä½ æƒ³è¦ç»ƒä¹ çš„ç®—æœ¯ç±»å‹ï¼šåŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•æˆ–é™¤æ³•ã€‚</p>
                    </div>
                    <div>
                        <h4 class="font-bold mb-2">3. é€‰æ‹©éš¾åº¦çº§åˆ«</h4>
                        <p>æ ¹æ®ä½ çš„èƒ½åŠ›é€‰æ‹©éš¾åº¦çº§åˆ«ï¼šåˆçº§ã€ä¸­çº§æˆ–é«˜çº§ã€‚</p>
                    </div>
                    <div>
                        <h4 class="font-bold mb-2">4. å¼€å§‹åšé¢˜</h4>
                        <p>åœ¨æ•°å­—é”®ç›˜ä¸Šè¾“å…¥ç­”æ¡ˆï¼Œç„¶åç‚¹å‡»"æäº¤"æŒ‰é’®ã€‚</p>
                    </div>
                    <div>
                        <h4 class="font-bold mb-2">5. ä½¿ç”¨è¾…åŠ©åŠŸèƒ½</h4>
                        <p>ç‚¹å‡»"å¬é¢˜ç›®"æŒ‰é’®å¯ä»¥å¬åˆ°é¢˜ç›®æœ—è¯»ï¼Œç‚¹å‡»"æç¤º"æŒ‰é’®å¯ä»¥æŸ¥çœ‹è®¡ç®—è¿‡ç¨‹ã€‚</p>
                    </div>
                </div>
                <div class="mt-8 text-center">
                    <button id="gotItBtn" class="bg-primary text-white px-6 py-3 rounded-xl font-bold">
                        æˆ‘çŸ¥é“äº†
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- é¡µè„š -->
    <footer class="bg-dark text-white py-8 mt-12">
        <div class="container mx-auto px-4 text-center">
            <p>è¶£å‘³å£ç®—ç»ƒä¹ å·¥å…· &copy; 2026</p>
            <p class="text-gray-400 text-sm mt-2">ä¸“ä¸ºå¹¼å°è¡”æ¥é˜¶æ®µçš„å„¿ç«¥è®¾è®¡</p>
        </div>
    </footer>

    <script>
        // å…¨å±€å˜é‡
        let currentSettings = {
            type: 'addition',
            level: 'easy'
        };
        let currentQuestion = {
            num1: 0,
            num2: 0,
            operator: '+',
            answer: 0
        };
        let userAnswer = '';
        let questions = [];
        let currentQuestionIndex = 0;
        let correctCount = 0;
        let soundEnabled = true;
        let isPracticeActive = false;
        
        // DOM å…ƒç´ 
        const welcomeSection = document.getElementById('welcomeSection');
        const settingsSection = document.getElementById('settingsSection');
        const practiceSection = document.getElementById('practiceSection');
        const resultSection = document.getElementById('resultSection');
        const achievementsSection = document.getElementById('achievementsSection');
        
        const startPracticeBtn = document.getElementById('startPractice');
        const viewAchievementsBtn = document.getElementById('viewAchievements');
        const confirmSettingsBtn = document.getElementById('confirmSettings');
        const practiceTypeBtns = document.querySelectorAll('.practice-type-btn');
        const difficultyBtns = document.querySelectorAll('.difficulty-btn');
        const numberBtns = document.querySelectorAll('.number-btn');
        const clearBtn = document.getElementById('clearBtn');
        const submitBtn = document.getElementById('submitBtn');
        const listenQuestionBtn = document.getElementById('listenQuestion');
        const showHintBtn = document.getElementById('showHint');
        const skipQuestionBtn = document.getElementById('skipQuestion');
        const retryBtn = document.getElementById('retryBtn');
        const changeSettingsBtn = document.getElementById('changeSettingsBtn');
        const backToWelcomeBtn = document.getElementById('backToWelcomeBtn');
        const backFromAchievementsBtn = document.getElementById('backFromAchievementsBtn');
        const backToWelcomeFromPracticeBtn = document.getElementById('backToWelcomeFromPractice');
        const backToWelcomeFromSettingsBtn = document.getElementById('backToWelcomeFromSettings');
        
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const num1El = document.getElementById('num1');
        const operatorEl = document.getElementById('operator');
        const num2El = document.getElementById('num2');
        const answerBoxEl = document.getElementById('answerBox');
        const answerEl = document.getElementById('answer');
        const calculationVisualizationEl = document.getElementById('calculationVisualization');
        const visualizationStepsEl = document.getElementById('visualizationSteps');
        
        const resultEmojiEl = document.getElementById('resultEmoji');
        const resultTitleEl = document.getElementById('resultTitle');
        const resultMessageEl = document.getElementById('resultMessage');
        const correctCountEl = document.getElementById('correctCount');
        const accuracyEl = document.getElementById('accuracy');
        
        const soundToggleBtn = document.getElementById('soundToggle');
        const helpBtn = document.getElementById('helpBtn');
        const helpModal = document.getElementById('helpModal');
        const closeHelpModalBtn = document.getElementById('closeHelpModal');
        const gotItBtn = document.getElementById('gotItBtn');
        
        // åˆå§‹åŒ–
        function init() {
            // äº‹ä»¶ç›‘å¬
            setupEventListeners();
        }
        
        // è®¾ç½®äº‹ä»¶ç›‘å¬
        function setupEventListeners() {
            // æ¬¢è¿åŒºæŒ‰é’®
            startPracticeBtn.addEventListener('click', () => {
                welcomeSection.classList.add('hidden');
                settingsSection.classList.remove('hidden');
            });
            
            viewAchievementsBtn.addEventListener('click', () => {
                welcomeSection.classList.add('hidden');
                achievementsSection.classList.remove('hidden');
            });
            
            // ç»ƒä¹ ç±»å‹æŒ‰é’®
            practiceTypeBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    practiceTypeBtns.forEach(b => b.classList.remove('ring-2', 'ring-primary'));
                    btn.classList.add('ring-2', 'ring-primary');
                    currentSettings.type = btn.dataset.type;
                });
            });
            
            // éš¾åº¦çº§åˆ«æŒ‰é’®
            difficultyBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    difficultyBtns.forEach(b => b.classList.remove('ring-2', 'ring-primary'));
                    btn.classList.add('ring-2', 'ring-primary');
                    currentSettings.level = btn.dataset.level;
                });
            });
            
            // ç¡®è®¤è®¾ç½®æŒ‰é’®
            confirmSettingsBtn.addEventListener('click', startPractice);
            
            // æ•°å­—æŒ‰é’®
            numberBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    if (userAnswer.length < 3) {
                        userAnswer += btn.textContent;
                        updateAnswerDisplay();
                    }
                });
            });
            
            // æ¸…é™¤æŒ‰é’®
            clearBtn.addEventListener('click', () => {
                userAnswer = '';
                updateAnswerDisplay();
            });
            
            // æäº¤æŒ‰é’®
            submitBtn.addEventListener('click', checkAnswer);
            
            // å¬é¢˜ç›®æŒ‰é’®
            listenQuestionBtn.addEventListener('click', speakQuestion);
            
            // æç¤ºæŒ‰é’®
            showHintBtn.addEventListener('click', showHint);
            
            // è·³è¿‡æŒ‰é’®
            skipQuestionBtn.addEventListener('click', nextQuestion);
            
            // ç»“æœåŒºæŒ‰é’®
            retryBtn.addEventListener('click', startPractice);
            
            changeSettingsBtn.addEventListener('click', () => {
                resultSection.classList.add('hidden');
                settingsSection.classList.remove('hidden');
            });
            
            backToWelcomeBtn.addEventListener('click', () => {
                resultSection.classList.add('hidden');
                welcomeSection.classList.remove('hidden');
            });
            
            // æˆå°±åŒºè¿”å›æŒ‰é’®
            backFromAchievementsBtn.addEventListener('click', () => {
                achievementsSection.classList.add('hidden');
                welcomeSection.classList.remove('hidden');
            });
            
            // ç»ƒä¹ åŒºè¿”å›ä¸»é¡µæŒ‰é’®
            document.getElementById('backToWelcomeFromPractice').addEventListener('click', function() {
                document.getElementById('practiceSection').classList.add('hidden');
                document.getElementById('welcomeSection').classList.remove('hidden');
            });
            
            // è®¾ç½®åŒºè¿”å›ä¸»é¡µæŒ‰é’®
            document.getElementById('backToWelcomeFromSettings').addEventListener('click', function() {
                document.getElementById('settingsSection').classList.add('hidden');
                document.getElementById('welcomeSection').classList.remove('hidden');
            });
            
            // å£°éŸ³åˆ‡æ¢æŒ‰é’®
            soundToggleBtn.addEventListener('click', () => {
                soundEnabled = !soundEnabled;
                soundToggleBtn.innerHTML = soundEnabled ? '<span class="text-xl">ğŸ”Š</span>' : '<span class="text-xl">ğŸ”‡</span>';
            });
            
            // å¸®åŠ©æŒ‰é’®
            helpBtn.addEventListener('click', () => {
                helpModal.classList.remove('hidden');
            });
            
            // å…³é—­å¸®åŠ©æ¨¡æ€æ¡†
            closeHelpModalBtn.addEventListener('click', () => {
                helpModal.classList.add('hidden');
            });
            
            gotItBtn.addEventListener('click', () => {
                helpModal.classList.add('hidden');
            });
        }
        
        // å¼€å§‹ç»ƒä¹ 
        function startPractice() {
            // éšè—å…¶ä»–éƒ¨åˆ†
            settingsSection.classList.add('hidden');
            resultSection.classList.add('hidden');
            practiceSection.classList.remove('hidden');
            
            // åˆå§‹åŒ–ç»ƒä¹ 
            currentQuestionIndex = 0;
            correctCount = 0;
            userAnswer = '';
            
            // ç”Ÿæˆé¢˜ç›®
            generateQuestions();
            
            // æ˜¾ç¤ºç¬¬ä¸€é¢˜
            showQuestion();
            
            // æ›´æ–°è¿›åº¦
            updateProgress();
            
            // æœ—è¯»é¢˜ç›®
            speakQuestion();
        }
        
        // ç”Ÿæˆé¢˜ç›®
        function generateQuestions() {
            questions = [];
            let numRange = 5;
            
            // æ ¹æ®éš¾åº¦è®¾ç½®æ•°å­—èŒƒå›´
            switch (currentSettings.level) {
                case 'easy':
                    numRange = 5;
                    break;
                case 'medium':
                    numRange = 10;
                    break;
                case 'hard':
                    numRange = 20;
                    break;
            }
            
            // ç”Ÿæˆ10é“é¢˜ç›®
            for (let i = 0; i < 10; i++) {
                let num1, num2, answer, operator;
                
                switch (currentSettings.type) {
                    case 'addition':
                        num1 = Math.floor(Math.random() * numRange) + 1;
                        num2 = Math.floor(Math.random() * numRange) + 1;
                        answer = num1 + num2;
                        operator = '+';
                        break;
                    case 'subtraction':
                        num1 = Math.floor(Math.random() * numRange) + 1;
                        num2 = Math.floor(Math.random() * num1) + 1;
                        answer = num1 - num2;
                        operator = '-';
                        break;
                }
                
                questions.push({ num1, num2, operator, answer });
            }
        }
        
        // æ˜¾ç¤ºé¢˜ç›®
        function showQuestion() {
            currentQuestion = questions[currentQuestionIndex];
            num1El.textContent = currentQuestion.num1;
            operatorEl.textContent = currentQuestion.operator;
            num2El.textContent = currentQuestion.num2;
            userAnswer = '';
            updateAnswerDisplay();
            calculationVisualizationEl.classList.add('hidden');
        }
        
        // æ›´æ–°ç­”æ¡ˆæ˜¾ç¤º
        function updateAnswerDisplay() {
            if (userAnswer === '') {
                answerEl.textContent = '?';
                answerBoxEl.classList.remove('bg-success', 'bg-danger');
            } else {
                answerEl.textContent = userAnswer;
            }
        }
        
        // æ›´æ–°è¿›åº¦
        function updateProgress() {
            const progress = ((currentQuestionIndex) / questions.length) * 100;
            progressBar.style.width = `${progress}%`;
            progressText.textContent = `${currentQuestionIndex}/${questions.length}`;
        }
        
        // æ£€æŸ¥ç­”æ¡ˆ
        function checkAnswer() {
            if (userAnswer === '') return;
            
            const isCorrect = parseInt(userAnswer) === currentQuestion.answer;
            
            if (isCorrect) {
                correctCount++;
                answerBoxEl.classList.remove('bg-danger');
                answerBoxEl.classList.add('bg-success');
                speakText('æ­£ç¡®ï¼');
                
                // å»¶è¿Ÿåè¿›å…¥ä¸‹ä¸€é¢˜
                setTimeout(() => {
                    nextQuestion();
                }, 1000);
            } else {
                answerBoxEl.classList.remove('bg-success');
                answerBoxEl.classList.add('bg-danger');
                speakText('é”™è¯¯ï¼Œè¯·å†è¯•ä¸€æ¬¡ã€‚');
                // é”™è¯¯æ—¶ä¸è‡ªåŠ¨è·³é¢˜ï¼Œè®©ç”¨æˆ·æŸ¥çœ‹æç¤º
            }
        }
        
        // ä¸‹ä¸€é¢˜
        function nextQuestion() {
            currentQuestionIndex++;
            
            if (currentQuestionIndex < questions.length) {
                updateProgress();
                showQuestion();
                speakQuestion();
            } else {
                showResult();
            }
        }
        
        // æ˜¾ç¤ºç»“æœ
        function showResult() {
            practiceSection.classList.add('hidden');
            resultSection.classList.remove('hidden');
            
            const accuracy = Math.round((correctCount / questions.length) * 100);
            
            correctCountEl.textContent = correctCount;
            accuracyEl.textContent = `${accuracy}%`;
            
            // æ ¹æ®æ­£ç¡®ç‡æ˜¾ç¤ºä¸åŒçš„ç»“æœ
            if (accuracy === 100) {
                resultEmojiEl.textContent = 'ğŸ‰';
                resultTitleEl.textContent = 'å¤ªæ£’äº†ï¼';
                resultMessageEl.textContent = 'ä½ æ˜¯ç®—æœ¯å°å¤©æ‰ï¼';
                speakText('æ­å–œä½ ï¼Œæ‰€æœ‰é¢˜ç›®éƒ½ç­”å¯¹äº†ï¼ä½ æ˜¯ç®—æœ¯å°å¤©æ‰ï¼');
            } else if (accuracy >= 80) {
                resultEmojiEl.textContent = 'ğŸ‘';
                resultTitleEl.textContent = 'åšå¾—å¾ˆå¥½ï¼';
                resultMessageEl.textContent = 'ç»§ç»­åŠªåŠ›ï¼Œä½ ä¼šæ›´æ£’çš„ï¼';
                speakText(`æ­å–œä½ ï¼Œæ­£ç¡®ç‡è¾¾åˆ°äº†${accuracy}%ï¼Œåšå¾—å¾ˆå¥½ï¼`);
            } else if (accuracy >= 60) {
                resultEmojiEl.textContent = 'ğŸ‘';
                resultTitleEl.textContent = 'ä¸é”™å“¦ï¼';
                resultMessageEl.textContent = 'å¤šç»ƒä¹ ä¼šæ›´å¥½çš„ï¼';
                speakText(`ä½ çš„æ­£ç¡®ç‡æ˜¯${accuracy}%ï¼Œä¸é”™å“¦ï¼Œå¤šç»ƒä¹ ä¼šæ›´å¥½çš„ï¼`);
            } else {
                resultEmojiEl.textContent = 'ğŸ’ª';
                resultTitleEl.textContent = 'ç»§ç»­åŠ æ²¹ï¼';
                resultMessageEl.textContent = 'ç›¸ä¿¡ä½ ä¸‹æ¬¡ä¼šåšå¾—æ›´å¥½ï¼';
                speakText(`ä½ çš„æ­£ç¡®ç‡æ˜¯${accuracy}%ï¼Œç»§ç»­åŠ æ²¹ï¼Œç›¸ä¿¡ä½ ä¸‹æ¬¡ä¼šåšå¾—æ›´å¥½ï¼`);
            }
        }
        
        // æœ—è¯»é¢˜ç›®
        function speakQuestion() {
            if (!soundEnabled) return;
            
            const text = `${currentQuestion.num1} ${getOperatorText(currentQuestion.operator)} ${currentQuestion.num2} ç­‰äºå¤šå°‘ï¼Ÿ`;
            speakText(text);
        }
        
        // è·å–è¿ç®—ç¬¦æ–‡æœ¬
        function getOperatorText(operator) {
            switch (operator) {
                case '+': return 'åŠ ';
                case '-': return 'å‡';
                case 'Ã—': return 'ä¹˜';
                case 'Ã·': return 'é™¤ä»¥';
                default: return '';
            }
        }
        
        // æ˜¾ç¤ºæç¤º
        function showHint() {
            calculationVisualizationEl.classList.remove('hidden');
            visualizationStepsEl.innerHTML = '';
            
            const { num1, num2, operator, answer } = currentQuestion;
            
            switch (operator) {
                case '+':
                    // åˆ†è§£åŠ æ³•
                    if (num1 <= 10 && num2 <= 10) {
                        // ç®€å•åŠ æ³•
                        visualizationStepsEl.innerHTML = `
                            <div class="flex items-center justify-center gap-4">
                                ${Array(num1).fill('ğŸ”´').join('')}
                                <span class="text-xl">+</span>
                                ${Array(num2).fill('ğŸŸ¡').join('')}
                                <span class="text-xl">=</span>
                                ${Array(answer).fill('ğŸ”µ').join('')}
                            </div>
                            <div class="text-center mb-4">
                                <p>${num1} + ${num2} = ${answer}</p>
                            </div>
                            ${(num1 + num2 >= 10) ? `
                                <div class="bg-yellow-100 p-4 rounded-lg mb-4">
                                    <h4 class="font-bold mb-2">å‡‘åæ³•</h4>
                                    <div class="flex flex-col gap-3">
                                        <div>
                                            <p>æ­¥éª¤1ï¼šæŠŠ${num2}åˆ†æˆ${10 - num1}å’Œ${num2 - (10 - num1)}</p>
                                            <div class="flex justify-center gap-2 mt-2">
                                                ${Array(num2).fill('ğŸŸ¡').join('')}
                                                <span class="text-lg">â†’</span>
                                                ${Array(10 - num1).fill('ğŸŸ¡').join('')}
                                                <span class="text-lg">+</span>
                                                ${Array(num2 - (10 - num1)).fill('ğŸŸ¡').join('')}
                                            </div>
                                        </div>
                                        <div>
                                            <p>æ­¥éª¤2ï¼š${num1} + ${10 - num1} = 10</p>
                                            <div class="flex justify-center gap-2 mt-2">
                                                ${Array(num1).fill('ğŸ”´').join('')}
                                                <span class="text-lg">+</span>
                                                ${Array(10 - num1).fill('ğŸŸ¡').join('')}
                                                <span class="text-lg">=</span>
                                                ${Array(10).fill('ğŸ”µ').join('')}
                                            </div>
                                        </div>
                                        <div>
                                            <p>æ­¥éª¤3ï¼š10 + ${num2 - (10 - num1)} = ${answer}</p>
                                            <div class="flex justify-center gap-2 mt-2">
                                                ${Array(10).fill('ğŸ”µ').join('')}
                                                <span class="text-lg">+</span>
                                                ${Array(num2 - (10 - num1)).fill('ğŸŸ¡').join('')}
                                                <span class="text-lg">=</span>
                                                ${Array(answer).fill('ğŸŸ¢').join('')}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ` : ''}
                        `;
                    } else {
                        // è¿›ä½åŠ æ³•
                        const ones1 = num1 % 10;
                        const tens1 = Math.floor(num1 / 10);
                        const ones2 = num2 % 10;
                        const tens2 = Math.floor(num2 / 10);
                        const onesSum = ones1 + ones2;
                        const tensSum = tens1 + tens2 + (onesSum >= 10 ? 1 : 0);
                        const onesResult = onesSum % 10;
                        
                        visualizationStepsEl.innerHTML = `
                            <div class="mb-4">
                                <p>æ­¥éª¤1ï¼šåˆ†è§£æ•°å­—</p>
                                <div class="flex justify-center gap-8 mt-2">
                                    <div>
                                        <p>${num1} = ${tens1}0 + ${ones1}</p>
                                    </div>
                                    <div>
                                        <p>${num2} = ${tens2}0 + ${ones2}</p>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-4">
                                <p>æ­¥éª¤2ï¼šä¸ªä½ç›¸åŠ </p>
                                <div class="flex justify-center gap-4 mt-2">
                                    <p>${ones1} + ${ones2} = ${onesSum}</p>
                                    ${onesSum >= 10 ? '<p class="text-primary">éœ€è¦è¿›ä½ï¼</p>' : ''}
                                </div>
                            </div>
                            <div class="mb-4">
                                <p>æ­¥éª¤3ï¼šåä½ç›¸åŠ </p>
                                <div class="flex justify-center gap-4 mt-2">
                                    <p>${tens1}0 + ${tens2}0 ${onesSum >= 10 ? '+ 10' : ''} = ${tensSum}0</p>
                                </div>
                            </div>
                            <div class="mb-4">
                                <p>æ­¥éª¤4ï¼šåˆå¹¶ç»“æœ</p>
                                <div class="flex justify-center gap-4 mt-2">
                                    <p>${tensSum}0 + ${onesResult} = ${answer}</p>
                                </div>
                            </div>
                            ${onesSum >= 10 ? `
                                <div class="bg-yellow-100 p-4 rounded-lg mt-4">
                                    <h4 class="font-bold mb-2">å‡‘åæ³•</h4>
                                    <p>æ­¥éª¤1ï¼šæŠŠä¸ªä½æ•°å­—${ones2}åˆ†æˆ${10 - ones1}å’Œ${ones2 - (10 - ones1)}</p>
                                    <p>æ­¥éª¤2ï¼š${ones1} + ${10 - ones1} = 10</p>
                                    <p>æ­¥éª¤3ï¼š10 + ${ones2 - (10 - ones1)} = ${onesSum}</p>
                                    <p>æ­¥éª¤4ï¼š${tens1}0 + ${tens2}0 + 10 = ${answer}</p>
                                </div>
                            ` : ''}
                        `;
                    }
                    break;
                    
                case '-':
                    // åˆ†è§£å‡æ³•
                    if (num1 % 10 >= num2 % 10) {
                        // ä¸éœ€è¦å€Ÿä½çš„å‡æ³•
                        visualizationStepsEl.innerHTML = `
                            <div class="flex items-center justify-center gap-4">
                                ${Array(num1).fill('ğŸ”´').join('')}
                                <span class="text-xl">-</span>
                                ${Array(num2).fill('ğŸŸ¡').join('')}
                                <span class="text-xl">=</span>
                                ${Array(answer).fill('ğŸ”µ').join('')}
                            </div>
                            <div class="text-center">
                                <p>${num1} - ${num2} = ${answer}</p>
                            </div>
                        `;
                    } else {
                        // éœ€è¦å€Ÿä½çš„å‡æ³•
                        const ones1 = num1 % 10;
                        const tens1 = Math.floor(num1 / 10);
                        const ones2 = num2 % 10;
                        const tens2 = Math.floor(num2 / 10);
                        const onesDiff = ones1 + 10 - ones2;
                        const tensDiff = tens1 - 1 - tens2;
                        
                        visualizationStepsEl.innerHTML = `
                            <div class="mb-4">
                                <p>æ­¥éª¤1ï¼šåˆ†è§£æ•°å­—</p>
                                <div class="flex justify-center gap-8 mt-2">
                                    <div>
                                        <p>${num1} = ${tens1}0 + ${ones1}</p>
                                    </div>
                                    <div>
                                        <p>${num2} = ${tens2}0 + ${ones2}</p>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-4">
                                <p>æ­¥éª¤2ï¼šä¸ªä½ç›¸å‡ï¼ˆéœ€è¦å€Ÿä½ï¼‰</p>
                                <div class="flex justify-center gap-4 mt-2">
                                    <p>${ones1} < ${ones2}ï¼Œæ‰€ä»¥ä»åä½å€Ÿ10</p>
                                    <p>${ones1} + 10 = ${ones1 + 10}</p>
                                    <p>${ones1 + 10} - ${ones2} = ${onesDiff}</p>
                                </div>
                            </div>
                            <div class="mb-4">
                                <p>æ­¥éª¤3ï¼šåä½ç›¸å‡ï¼ˆæ³¨æ„å·²ç»å€Ÿäº†1ï¼‰</p>
                                <div class="flex justify-center gap-4 mt-2">
                                    <p>${tens1}0 - 10 = ${tens1 - 1}0</p>
                                    <p>${tens1 - 1}0 - ${tens2}0 = ${tensDiff}0</p>
                                </div>
                            </div>
                            <div class="mb-4">
                                <p>æ­¥éª¤4ï¼šåˆå¹¶ç»“æœ</p>
                                <div class="flex justify-center gap-4 mt-2">
                                    <p>${tensDiff}0 + ${onesDiff} = ${answer}</p>
                                </div>
                            </div>
                            <div class="bg-yellow-100 p-4 rounded-lg mt-4">
                                <h4 class="font-bold mb-2">ç ´åæ³•</h4>
                                <div class="flex flex-col gap-3">
                                    <div>
                                        <p>æ­¥éª¤1ï¼šæŠŠ${num1}åˆ†æˆ10å’Œ${num1 - 10}</p>
                                        <div class="flex justify-center gap-2 mt-2">
                                            ${Array(num1).fill('ğŸ”´').join('')}
                                            <span class="text-lg">â†’</span>
                                            ${Array(10).fill('ğŸ”´').join('')}
                                            <span class="text-lg">+</span>
                                            ${Array(num1 - 10).fill('ğŸ”´').join('')}
                                        </div>
                                    </div>
                                    <div>
                                        <p>æ­¥éª¤2ï¼š10 - ${ones2} = ${10 - ones2}</p>
                                        <div class="flex justify-center gap-2 mt-2">
                                            ${Array(10).fill('ğŸ”´').join('')}
                                            <span class="text-lg">-</span>
                                            ${Array(ones2).fill('ğŸŸ¡').join('')}
                                            <span class="text-lg">=</span>
                                            ${Array(10 - ones2).fill('ğŸ”µ').join('')}
                                        </div>
                                    </div>
                                    <div>
                                        <p>æ­¥éª¤3ï¼š${10 - ones2} + ${num1 - 10} = ${answer}</p>
                                        <div class="flex justify-center gap-2 mt-2">
                                            ${Array(10 - ones2).fill('ğŸ”µ').join('')}
                                            <span class="text-lg">+</span>
                                            ${Array(num1 - 10).fill('ğŸ”´').join('')}
                                            <span class="text-lg">=</span>
                                            ${Array(answer).fill('ğŸŸ¢').join('')}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `;
                    }
                    break;
            }
            
            // æœ—è¯»æç¤º
            speakText('æç¤ºï¼š' + getHintText());
        }
        
        // è·å–æç¤ºæ–‡æœ¬
        function getHintText() {
            const { num1, num2, operator, answer } = currentQuestion;
            
            switch (operator) {
                case '+':
                    return `${num1}åŠ ${num2}ç­‰äº${answer}`;
                case '-':
                    return `${num1}å‡${num2}ç­‰äº${answer}`;
                default:
                    return '';
            }
        }
        
        // æœ—è¯»æ–‡æœ¬
        function speakText(text) {
            if (!soundEnabled) return;
            
            const speech = new SpeechSynthesisUtterance(text);
            speech.lang = 'zh-CN';
            speech.rate = 0.95; // ç¨æ…¢ä½†æ›´è‡ªç„¶
            speech.pitch = 1.0; // æ­£å¸¸éŸ³è°ƒ
            speech.volume = 1;
            
            // å°è¯•é€‰æ‹©æ›´è‡ªç„¶çš„ä¸­æ–‡è¯­éŸ³
            const voices = speechSynthesis.getVoices();
            const chineseVoice = voices.find(voice => 
                voice.lang === 'zh-CN' || 
                voice.lang === 'zh' ||
                voice.name.includes('Chinese') ||
                voice.name.includes('ä¸­æ–‡')
            );
            
            if (chineseVoice) {
                speech.voice = chineseVoice;
            }
            
            speechSynthesis.speak(speech);
        }
        
        // é¢„åŠ è½½è¯­éŸ³åˆ—è¡¨
        window.speechSynthesis.onvoiceschanged = function() {
            // è¯­éŸ³åˆ—è¡¨åŠ è½½å®Œæˆï¼Œæ— éœ€é¢å¤–æ“ä½œ
        };
        
        // åˆå§‹åŒ–åº”ç”¨
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
